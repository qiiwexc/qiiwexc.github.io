function Set-MalwareProtectionConfiguration {
    param(
        [String][Parameter(Position = 0, Mandatory)]$SourcePath,
        [Collections.Generic.List[String]][Parameter(Position = 1, Mandatory)]$TemplateContent
    )

    [Collections.Generic.List[String]]$Configuration = Read-TextFile -AsList "$SourcePath\4-functions\Configuration\Windows\Set-MalwareProtectionConfiguration.ps1"

    [Collections.Generic.List[String]]$FormattedConfiguration = ''
    $Configuration | Where-Object { $_ -match 'Set-MpPreference' } | ForEach-Object {
        [String]$Line = $_.trim()
        $FormattedConfiguration.Add("$Line`n")
    }

    return $TemplateContent.Replace('{WINDOWS_MALWARE_PROTECTION_CONFIGURATION}', -join $FormattedConfiguration)
}
